{"author":"Maurizio Boero","core-version":">=5.1.19","created":"20190108145021447","dependents":"FontAwesome CustomTemplates kin-filter","description":"DocToolPlugin","modified":"20190505104525141","plugin-type":"plugin","revision":"1","source":"https://github.com/mauloop/tw5-doc-tool","title":"$:/plugins/mau/DocTool","type":"application/json","version":"0.1.13","tiddlers":{"$:/plugins/mau/DocTool/config/doc-css":{"text":".noBorder,.noBorder td,.noBorder th,.noBorder tr {border:0}\n\n.topic-path {\n    max-width: 90vw;\n    display: block;\n    overflow: auto;\n}\n\n/* Two columns story layout\n.tc-story-river {   display: flex;   flex-wrap: wrap; }\n.tc-tiddler-frame { max-width: 49%; margin-right: 1%; }\n.tc-tiddler-body { max-height: 12em; overflow: auto; }\n*/\n\n/* Two columns below-story layout */\n.below-story {   display: flex;   flex-wrap: wrap; }\n.below-story .tc-tiddler-frame { height: 18em; max-width: 49%; margin-right: 1%; }\n.below-story .tc-tiddler-title { height: 8em; }\n.below-story .tc-tiddler-body { height: 6em; overflow: auto; }","bag":"default","revision":"0","type":"text/css","title":"$:/plugins/mau/DocTool/config/doc-css","tags":"$:/tags/Stylesheet DocToolPlugin","modified":"20190213173303447","created":"20181226175427303"},"$:/plugins/mau/DocTool/config/doc-id":{"text":"","bag":"default","revision":"0","type":"text/plain","title":"$:/plugins/mau/DocTool/config/doc-id","tags":"DocToolPlugin","modified":"20190309201435993","created":"20181226170948536"},"$:/plugins/mau/DocTool/config/doc-root":{"text":"Home","bag":"default","revision":"0","type":"text/plain","title":"$:/plugins/mau/DocTool/config/doc-root","tags":"DocToolPlugin","modified":"20190213173346256","created":"20190119003836676"},"$:/plugins/mau/DocTool/exporters/json4docx":{"text":"\\define renderContent()\n{{{ $(exportFilter)$ ||$:/core/templates/plain-text-tiddler}}}\n\\end\n<<renderContent>>\n","bag":"default","revision":"0","type":"text/vnd.tiddlywiki","title":"$:/plugins/mau/DocTool/exporters/json4docx","tags":"$:/tags/Exporter DocToolPlugin","modified":"20190213172329356","extension":".json","description":"JSON for DOCX","created":"20190107194802565"},"$:/plugins/mau/DocTool/macros/doc-path":{"text":"\\define doc-path(here)\n<table class=\"doc-path noBorder\"><tr>\n<$list filter=\"\"\"[all[shadows+tiddlers]kin:$(doc-id)$parent:from[$here$]sort[$(doc-id)$index]]\"\"\">\n<$set name=\"caret\" filter=\"\"\"[enlist[$here$]]\"\"\" value=\"\"\"<i class=\"fa fa-1x fa-caret-right\"/>\"\"\" emptyValue=\"\">\n<td style=\"white-space:nowrap;word-break:keep-all;\"><$link><<currentTiddler>> <<caret>></$link></td>\n</$set>\n</$list>\n</tr></table>\n\\end\n\n<!-- \n\\define doc-path(here, parent:\"\", path:\"\")\n<$set name=\"parent\" value={{{[[$here$]get[$(doc-id)$parent]]}}}>\n<$set name=\"next\" filter=\"\"\"[[$here$]get[$(doc-id)$parent]]\"\"\" value=\"doc-path-add\" emptyValue=\"doc-path-print\">\n<$macrocall $name=<<next>> here=\"\"\"$here$\"\"\" parent=<<parent>> path=\"\"\"$path$\"\"\" />\n</$set>\n</$set>\n\\end\n\n\\define doc-path-add(here, parent, path)\n<$macrocall $name=\"doc-path\" here=\"\"\"$parent$\"\"\" parent=\"\" path=\"\"\"[[$here$]] $path$\"\"\"/>\n\\end\n\n\\define doc-path-print(here, parent, path)\n<table class=\"doc-path noBorder\"><tr>\n<$list filter=\"\"\"[[$here$]] $path$\"\"\">\n<$set name=\"caret\" filter=\"\"\"[enlist[$here$]]\"\"\" value=\"\"\"<i class=\"fa fa-1x fa-caret-right\"/>\"\"\" emptyValue=\"\">\n<td style=\"white-space:nowrap;word-break:keep-all;\"><$link><<currentTiddler>> <<caret>></$link></td>\n</$set>\n</$list>\n</tr></table>\n\\end\n-->","bag":"default","revision":"0","type":"text/vnd.tiddlywiki","tmap.id":"e5425381-02ec-4ba3-af64-df2347c51029","title":"$:/plugins/mau/DocTool/macros/doc-path","tags":"DocToolPlugin $:/tags/Macro","modified":"20190503234557297","created":"20170719131238686"},"$:/plugins/mau/DocTool/macros/doc-toc":{"text":"\\define ok-to-write-index(t,ti) <$action-setfield $tiddler=\"\"\"$t$\"\"\" $field=\"\"\"$(doc-id)$index\"\"\" $value=\"$ti$\" />\n\n\\define set-ti(pi,i) $pi$.$i$\n\n\\define doc-rebuild-index-part() <$macrocall $name=\"doc-rebuild-index\" t={{!!title}} i={{!!$(doc-id)$index}} />\n\n\\define doc-rebuild-index(t,i,p,pi)\n<!--\nt: current topic\ni: incremental interger to append to pi to obtain current topic index (ti)\np: parent topic\npi: parent topic index (x.y. ...)\nti: topic index (x.y. ... .i)\n-->\n\n<$set name=\"ti\" filter=\"\"\"[enlist[$pi$]]\"\"\" value=<<set-ti \"\"\"$pi$\"\"\" \"\"\"$i$\"\"\">> emptyValue=\"\"\"$i$\"\"\">\n\n<$set name=\"write-index\" filter=\"\"\"[<ti>] -[[$t$]get[$(doc-id)$index]]\"\"\" value=\"ok-to-write-index\" emptyValue=\"do-not-write-index\">\n<$macrocall $name=<<write-index>> t=\"\"\"$t$\"\"\" ti=<<ti>> />\n</$set>\n\n<!-- $list filter=\"\"\"[has[$(doc-id)$parent]$(doc-id)$parent[$p$]sortby{$p$!!$(doc-id)$list}allafter[$t$]first[]]\"\"\" variable=\"list-item\" -->\n<$list filter=\"\"\"[all[shadows+tiddlers]kin:$(doc-id)$parent:to:1[$p$]![$p$]sortby{$p$!!$(doc-id)$list}allafter[$t$]first[]]\"\"\" variable=\"list-item\">\n<$macrocall $name=\"doc-rebuild-index\" t=<<list-item>> i=<<incr \"\"\"$i$\"\"\">> p=\"\"\"$p$\"\"\" pi=\"\"\"$pi$\"\"\"/>\n</$list>\n\n<!-- $list filter=\"\"\"[has[$(doc-id)$parent]$(doc-id)$parent[$t$]sortby{$t$!!$(doc-id)$list}first[]]\"\"\" variable=\"list-item\" -->\n<$list filter=\"\"\"[all[shadows+tiddlers]kin:$(doc-id)$parent:to:1[$t$]![$t$]sortby{$t$!!$(doc-id)$list}first[]]\"\"\" variable=\"list-item\">\n<$macrocall $name=\"doc-rebuild-index\" t=<<list-item>> i=\"1\" p=\"\"\"$t$\"\"\" pi=<<ti>>/>\n</$list>\n\n</$set>\n\\end\n\n\\define doc-toc-state() $:/state/toc/$(currentTiddler)$\n\n\\define caret(expand:\"yes\", recurse:\"yes\") <$reveal type=\"match\" text=\"yes-yes\" default=\"\"\"$expand$-$recurse$\"\"\" ><$set name=\"c\" filter=\"\"\"[{$(doc-toc-state)$}] -[[show]]\"\"\" value=\"caret-right\" emptyValue=\"caret-down\"><$macrocall $name=<<c>>/></$set></$reveal>\n\n\\define caret-right() <$button set=<<doc-toc-state>> setTo=\"show\" class=\"tc-btn-invisible tc-tiddlylink\"><i class=\"fa fa-1x fa-caret-right\"/></$button>\n\n\\define caret-down() <$button class=\"tc-btn-invisible tc-tiddlylink\"><i class=\"fa fa-1x fa-caret-down\"/><$action-deletetiddler $tiddler=<<doc-toc-state>> /></$button>\n\n\\define doc-toc-recurse(expand:\"yes\", recurse:\"yes\", edit:\"yes\", rebuild:\"yes\") \n\n<$reveal type=\"match\" text=\"yes-yes\" default=\"\"\"$expand$-$recurse$\"\"\" >\n<$set name=\"r\" filter=\"\"\"[{$(doc-toc-state)$}] -[[show]]\"\"\" value=\"\" emptyValue=\"doc-toc\"><$macrocall $name=<<r>> root=<<currentTiddler>> expand=\"\"\"$expand$\"\"\" recurse=\"\"\"$recurse$\"\"\" edit=\"\"\"$edit$\"\"\" rebuild=\"\"\"$rebuild$\"\"\"/></$set>\n</$reveal>\n\n<$reveal type=\"match\" text=\"no-yes\" default=\"\"\"$expand$-$recurse$\"\"\" >\n<<doc-toc \"\"\"$(currentTiddler)$\"\"\" \"\"\"$expand$\"\"\" \"\"\"$recurse$\"\"\" \"\"\"$edit$\"\"\" \"no\">>\n</$reveal>\n\n\\end\n\n\n\\define ok-to-drop(p)\n<!-- $action-listops $tiddler=\"\"\"$p$\"\"\" $field=\"$(doc-id)$list\" $filter=\"\"\"[$(doc-id)$parent[$p$]sortby{$p$!!$(doc-id)$list}] +[insertbefore:currentTiddler<actionTiddler>]\"\"\"/ -->\n<$action-listops $tiddler=\"\"\"$p$\"\"\" $field=\"$(doc-id)$list\" $filter=\"\"\"[all[shadows+tiddlers]kin:$(doc-id)$parent:to:1[$p$]![$p$]sortby{$p$!!$(doc-id)$list}] +[insertbefore:currentTiddler<actionTiddler>]\"\"\"/>\n<!-- $action-setfield $tiddler=<<actionTiddler>> $(doc-id)$parent=\"\"\"$p$\"\"\"/ -->\n<$action-listops $tiddler=<<actionTiddler>> $field=\"\"\"$(doc-id)$parent\"\"\" $filter=\"\"\"[[$p$]]\"\"\"/>\n\\end\n\n\\define doc-toc-drop-actions(p)\n<!-- $set name=\"action-index\" value={{{[<actionTiddler>get[$(doc-id)$index]]}}}>\n<$set name=\"doc-toc-drop\" filter=\"\"\"[all[current]get[$(doc-id)$index]] +[removeprefix<action-index>]\"\"\" value=\"do-not-drop\"  emptyValue=\"ok-to-drop\" -->\n<$set name=\"doc-toc-drop\" filter=\"\"\"[all[shadows+tiddlers]kin:$(doc-id)$parent:to<actionTiddler>is[current]]\"\"\" value=\"do-not-drop\"  emptyValue=\"ok-to-drop\">\n<!-- DEBUG -->\n<!-- $action-setfield $tiddler=\"Debug\" ct=<<currentTiddler>> />\n<$action-setfield $tiddler=\"Debug\" at=<<actionTiddler>> />\n<$action-setfield $tiddler=\"Debug\" filter1={{{[all[shadows+tiddlers]kin:$(doc-id)$parent:to<actionTiddler>is[current]]}}} />\n<$action-listops $tiddler=\"Debug\" $field=\"filter2\" $filter=\"\"\"[all[shadows+tiddlers]kin:$(doc-id)$parent:to<actionTiddler>]\"\"\" / -->\n<!-- $action-setfield $tiddler=\"Debug\" ci={{{[all[current]get[$(doc-id)$index]]}}} />\n<$action-setfield $tiddler=\"Debug\" ai=<<action-index>> / -->\n<!-- DEBUG END -->\n<$macrocall $name=<<doc-toc-drop>> p=\"\"\"$p$\"\"\"/>\n</$set>\n<!-- /$set>\n</$set -->\n\\end\n\n\\define doc-toc(root, expand:\"yes\", recurse:\"yes\", edit:\"yes\", rebuild:\"yes\")\n<ul class=\"fa-ul\">\n<!-- $list filter=\"\"\"[has[$(doc-id)$parent]$(doc-id)$parent[$root$]sortby{$root$!!$(doc-id)$list}]\"\"\" -->\n<$list filter=\"\"\"[all[shadows+tiddlers]kin:$(doc-id)$parent:to:1[$root$]![$root$]sortby{$root$!!$(doc-id)$list}]\"\"\">\n<$vars i={{!!$(doc-id)$index}}>\n<$reveal type=\"match\" text=\"yes\" default=\"\"\"$edit$\"\"\" >\n<li><$droppable actions=<<doc-toc-drop-actions \"\"\"$root$\"\"\">> >\n<div class=\"tc-droppable-placeholder\">&nbsp;</div>\n<<caret \"\"\"$expand$\"\"\" \"\"\"$recurse$\"\"\">> <$link to={{!!title}}><$view field=\"$(doc-id)$index\"/> <$view field=\"caption\">{{!!title}}</$view></$link>\n</$droppable></li>\n</$reveal>\n<$reveal type=\"nomatch\" text=\"yes\" default=\"\"\"$edit$\"\"\" >\n<li><<caret \"\"\"$expand$\"\"\" \"\"\"$recurse$\"\"\">> <$link to={{!!title}}><$view field=\"$(doc-id)$index\"/> <$view field=\"caption\">{{!!title}}</$view></$link></li>\n</$reveal>\n</$vars>\n<<doc-toc-recurse \"\"\"$expand$\"\"\" \"\"\"$recurse$\"\"\" \"\"\"$edit$\"\"\" \"no\">>\n</$list>\n<$reveal type=\"match\" text=\"yes\" default=\"\"\"$edit$\"\"\" >\n<$tiddler tiddler=\"\"\"$root$\"\"\">\n<li><$droppable actions=<<doc-toc-drop-actions \"\"\"$root$\"\"\">> >\n<div class=\"tc-droppable-placeholder\">&nbsp;</div>\n@@color:transparent;=====@@\n</$droppable></li>\n</$tiddler>\n</$reveal>\n</ul>\n<$reveal type=\"match\" text=\"yes-yes\" default=\"\"\"$edit$-$rebuild$\"\"\" >\n<$button class=\"tc-btn-invisible tc-tiddlylink\" actions=<<doc-rebuild-index \"\"\"$root$\"\"\">>>\nRebuild index\n</$button>\n</$reveal>\n\\end\n","bag":"default","revision":"0","type":"text/vnd.tiddlywiki","tmap.id":"90e1c8fb-5069-4800-9497-87c9c2371c51","title":"$:/plugins/mau/DocTool/macros/doc-toc","tags":"$:/tags/Macro DocToolPlugin","modified":"20190503234119709","created":"20171204174122793"},"$:/plugins/mau/DocTool/ui/BelowStory":{"created":"20171025111006946","text":"\\define sort-by-parent() \"\"\"[all[shadows+tiddlers]kin:$(doc-id)$parent:to:1[$(parent)$]![$(parent)$]sortby{$(parent)$!!$(doc-id)$list}]\"\"\"\n\n<!-- \\define sort-by-parent() \"\"\"[has[$(doc-id)$parent]$(doc-id)$parent[$(parent)$]sortby{$(parent)$!!$(doc-id)$list}]\"\"\" -->\n\n<div class=\"below-story\">\n<$set name=\"doc-id\" value={{$:/plugins/mau/DocTool/config/doc-id}}>\n<$set name=\"parent\" filter=<<story-filter>> emptyValue={{{[{$:/plugins/mau/DocTool/config/doc-root}]}}}>\n<$wikify name=\"parent-list\" text=<<sort-by-parent>> >\n<$list filter=<<parent-list>> template=\"$:/plugins/mau/DocTool/ui/BelowStory/ViewTemplate\" />\n</$wikify>\n</$set>\n</$set>\n</div>\n\n\n","bag":"default","revision":"0","type":"text/vnd.tiddlywiki","title":"$:/plugins/mau/DocTool/ui/BelowStory","tags":"DocToolPlugin $:/tags/BelowStory","modified":"20190505104031275"},"$:/plugins/mau/DocTool/ui/BelowStory/ViewTemplate":{"text":"\\define frame-classes()\ntc-tiddler-frame tc-tiddler-view-frame $(missingTiddlerClass)$ $(shadowTiddlerClass)$ $(systemTiddlerClass)$ $(tiddlerTagClasses)$\n\\end\n\\define folded-state()\n$:/state/folded/$(currentTiddler)$\n\\end\n<$set name=\"storyTiddler\" value=<<currentTiddler>>><$set name=\"tiddlerInfoState\" value=<<qualify \"$:/state/popup/tiddler-info\">>><$tiddler tiddler=<<currentTiddler>>><div class=<<frame-classes>>><$list filter=\"\"\"[list[$:/plugins/mau/DocTool/ui/BelowStory/ViewTemplate]] +[!has[draft.of]]\"\"\" variable=\"listItem\"><$transclude tiddler=<<listItem>>/></$list>\n</div>\n</$tiddler></$set></$set>\n","bag":"default","revision":"0","type":"text/vnd.tiddlywiki","title":"$:/plugins/mau/DocTool/ui/BelowStory/ViewTemplate","tags":"DocToolPlugin","modified":"20190213173534108","list":"$:/plugins/mau/DocTool/ui/BelowStory/ViewTemplate/title $:/core/ui/ViewTemplate/body","created":"20171025130712197"},"$:/plugins/mau/DocTool/ui/BelowStory/ViewTemplate/title":{"text":"<$link>\n<h1 class=\"tc-title\">\n<$view field=\"title\"/>\n</h1>\n</$link>","bag":"default","revision":"0","type":"text/vnd.tiddlywiki","title":"$:/plugins/mau/DocTool/ui/BelowStory/ViewTemplate/title","tags":"DocToolPlugin","modified":"20190213173540347","created":"20171025133805820"},"$:/plugins/mau/DocTool/ui/SideBar/toc":{"text":"<$vars doc-id={{$:/plugins/mau/DocTool/config/doc-id}}><$macrocall $name=\"doc-toc\" root={{$:/plugins/mau/DocTool/config/doc-root}}/></$vars>","bag":"default","revision":"0","type":"text/vnd.tiddlywiki","title":"$:/plugins/mau/DocTool/ui/SideBar/toc","tags":"DocToolPlugin $:/tags/SideBar","modified":"20190213173547382","list-before":"$:/core/ui/SideBar/Open","created":"20190118105133400","caption":"Contents"},"$:/plugins/mau/DocTool/ui/TopLeftBar":{"created":"20170706132730799","text":"<$set name=\"doc-id\" value={{$:/plugins/mau/DocTool/config/doc-id}}>\n<$set name=\"h\" filter=<<story-filter>> emptyValue={{{[{$:/plugins/mau/DocTool/config/doc-root}]}}}>\n<$wikify name=\"here\" text=<<h>> >\n<$macrocall $name=\"doc-path\" here=<<here>> />\n</$wikify>\n</$set>\n</$set>","bag":"default","revision":"0","type":"text/vnd.tiddlywiki","tmap.id":"e5425381-02ec-4ba3-af64-df2347c51029","title":"$:/plugins/mau/DocTool/ui/TopLeftBar","tags":"DocToolPlugin $:/tags/TopLeftBar","modifier":"Maurizio Boero - Yotta Tecnologie s.r.l.","modified":"20190505103611765","creator":"Maurizio Boero - Yotta Tecnologie s.r.l."},"$:/plugins/mau/DocTool/ui/ViewToolbar/new-subtopic":{"text":"<span class=\"tc-popup-keep\">\n<$button class=\"tc-btn-invisible\" popup=<<qualify \"$:/state/popup/new-subtopic\">> >\n<i class=\"fa fa-book\" aria-hidden=\"true\"></i>\n</$button>\n</span>\n<$reveal state=<<qualify \"$:/state/popup/new-subtopic\">> type=\"popup\" position=\"below\" animate=\"yes\">\n<div class=\"tc-drop-down\">\n<$list filter=\"[all[shadows+tiddlers]tag[$:/tags/TopicType]]\" variable=\"topic-type\">\n<$transclude tiddler=<<topic-type>> />\n</$list>\n</div>\n</$reveal>","bag":"default","revision":"0","type":"text/vnd.tiddlywiki","title":"$:/plugins/mau/DocTool/ui/ViewToolbar/new-subtopic","tags":"DocToolPlugin $:/tags/ViewToolbar","modified":"20190213173602915","created":"20171204103151234"},"$:/plugins/mau/DocTool/ui/buttons/generic-subtopic":{"text":"\\define parent() [[$(currentTiddler)$]]\n\n<$button class=\"tc-btn-invisible\">\nGeneric subtopic\n<$action-sendmessage $message=\"tm-new-tiddler\" parent=<<parent>> />\n</$button>","bag":"default","revision":"0","type":"text/vnd.tiddlywiki","title":"$:/plugins/mau/DocTool/ui/buttons/generic-subtopic","tags":"DocToolPlugin $:/tags/TopicType","modified":"20190503155458870","created":"20171208105906609"}}}